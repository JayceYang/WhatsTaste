
<!doctype html>
<html>
<head>
    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, target-densitydpi=device-dpi"/>

    <title>Hybird</title>

    <style>
        *
        {
        //-webkit-tap-highlight-color: rgba(0,0,0,0);
        text-decoration: none;
        }

        html,body
        {
        -webkit-touch-callout: none;                /* prevent callout to copy image, etc when tap to hold */
        -webkit-text-size-adjust: none;             /* prevent webkit from resizing text to fit */
        -webkit-user-select: none;                  /* prevent copy paste, to allow, change 'none' to 'text' */
        }

        #div-a
        {
        background:#FBA;
        color:#FFF;

        border-radius: 25px 5px;
        }
    
        div,p
        {
            color:#EEE;
        }


    </style>
    <script type="text/javascript" src="//maps.googleapis.com/maps/api/js?sensor=true"></script>
    <script src="native_bridge.js"></script>

</head>

<body style="background:#CDE; color:#FFF">

<div>
    <font size="3" color="black">输入一个整数：</font>
    <textarea  id="input" style="font-size:10pt;color:black;"></textarea>
</div>
<br/>

<div>
    <font size="3" color="green">Native计算结果： <b id="result"> </b> </font>
</div>
<br/>

<div>
    <font size="3" color="blue">正在为Native计算： <b id="cal_for_native"> </b> </font>
</div>
<br/>

<div id="div-a">
    <center>
        <input type="file" capture="camera" accept="image/*" id="cameraInput" name="cameraInput" onclick="calculateByNative(input.value);" />
        <br/>
        <input type="button" value="JS调用Native计算平方" onclick="calculateByNative(input.value);" />
        <br/>
        <br/>

        <a id="push" href="#" onclick="pushWebViewController('http://www.baidu.com','百度一下');">
            跳转到新页面
        </a>

        <br/>
        <br/>

    </center>
</div>

<div id="div-a">
    <center>
        <p onclick="getLocation();">
            获取用户位置信息
        </p>
        <p id="userLocation">
            暂时还没有位置信息
        </p>
    </center>
</div>

<script type="text/javascript">
    
        var x=document.getElementById("userLocation");
        function getLocation()
        {
            if (navigator.geolocation)
            {
                navigator.geolocation.watchPosition(showPosition);
            }
            else{
                x.innerHTML="Geolocation is not supported by this browser.";
            }
        }

        function showPosition(position)
        {
            x.innerHTML="Latitude: " + position.coords.latitude +
            "<br />Longitude: " + position.coords.longitude;
            codeLatLng(position.coords.latitude, position.coords.longitude);
        }

        function codeLatLng(lat, lng) {
            var latlng = new google.maps.LatLng(lat, lng);
            geocoder.geocode({'latLng': latlng}, function(results, status) {
                 if (status == google.maps.GeocoderStatus.OK) {
                     console.log(results)
                     if (results[1]) {
                         //formatted address
                         alert(results[0].formatted_address)
                         //find country name
                         for (var i=0; i<results[0].address_components.length; i++) {
                            for (var b=0;b<results[0].address_components[i].types.length;b++) {
                         
                            //there are different types that might hold a city admin_area_lvl_1 usually does in come cases looking for sublocality type will be more appropriate
                            if (results[0].address_components[i].types[b] == "administrative_area_level_1") {
                                     //this is the object you are looking for
                                    city= results[0].address_components[i];
                                    break;
                                }
                            }
                         }
                             //city data
                         alert(city.short_name + " " + city.long_name)
                     } else {
                         alert("No results found");
                     }
                 } else {
                     alert("Geocoder failed due to: " + status);
                 }
            });
        }

        function pushWebViewController(destinationURL, title)
        {
            call_native("pushWebViewController", {'destinationURL': destinationURL, 'title': title});
        }

        function getUserLocation()
        {
            call_native("getUserLocation", null, getUserLocationResult);
        }

        function calculateByNative(value)
        {
            showResult("");
            call_native("calculate", {'squareValue': value}, showResult);
        }

        function calculateForNative(value, nativeCallback)
        {
            document.getElementById("cal_for_native").innerText = value["calculate"] + " * " + value["calculate"];
            var result = value["calculate"] * value["calculate"];
            setTimeout(function()
            {
                callback_to_native(nativeCallback, {"squareValueResult":result}, null);
               document.getElementById("cal_for_native").innerText = "";
            }, 1000);
        }

        function showResult(resultNumber)
        {
            document.getElementById("result").innerText = resultNumber["squareValueResult"];
        }

        function getUserLocationResult(resultDictionary)
        {
            document.getElementById("userLocation").innerText = resultDictionary["getUserLocationResult"];
        }

    </script>
</body>

</html>
